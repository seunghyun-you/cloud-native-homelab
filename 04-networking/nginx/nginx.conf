server {
        listen 80;
        listen [::]:80;

        root /var/www/html;

        index index.html index.htm index.nginx-debian.html;

        server_name _;
        return 301 https://$host$request_uri;
}

server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;
        client_max_body_size 10M;

        ssl_certificate "/etc/letsencrypt/live/container-wave.com/fullchain.pem";
        ssl_certificate_key "/etc/letsencrypt/live/container-wave.com/privkey.pem";

        server_name vscode.container-wave.com;

        location / {
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_set_header X-Real-IP $remote_addr;
                proxy_pass http://192.168.200.2:8080;
                proxy_ssl_server_name on;
        }
}


server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2 ;
        client_max_body_size 10M;

        ssl_certificate "/etc/letsencrypt/live/container-wave.com/fullchain.pem";
        ssl_certificate_key "/etc/letsencrypt/live/container-wave.com/privkey.pem";

        # ingress controller 
        server_name www.container-wave.com;

        location / {
                proxy_set_header Host $host;
                proxy_http_version 1.1;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_set_header X-Real-IP $remote_addr;
                proxy_pass http://192.168.200.2:9000;
                proxy_buffering off;
                proxy_cache off;
        }
}

server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2 ;
        client_max_body_size 10M;

        ssl_certificate "/etc/letsencrypt/live/container-wave.com/fullchain.pem";
        ssl_certificate_key "/etc/letsencrypt/live/container-wave.com/privkey.pem";

        server_name cicd.container-wave.com;

        location / {
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_set_header X-Real-IP $remote_addr;
                proxy_pass https://192.168.200.2:8443;
                proxy_http_version 1.1;
                proxy_buffering off;
                proxy_cache off;
                proxy_ssl_server_name on;
        }
}

server {
        listen 8080 ssl http2;
        listen [::]:8080 ssl http2 ;
        client_max_body_size 10M;

        ssl_certificate "/etc/letsencrypt/live/container-wave.com/fullchain.pem";
        ssl_certificate_key "/etc/letsencrypt/live/container-wave.com/privkey.pem";

        # jenkins
        server_name cicd.container-wave.com;

        location / {
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-Host $host;
                proxy_set_header X-Forwarded-Port $server_port;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_set_header X-Real-IP $remote_addr;
                proxy_pass http://192.168.200.2:18080;
                proxy_ssl_server_name on;
        }
}

server {
        listen 8081 ssl http2;
        listen [::]:8081 ssl http2 ;
        client_max_body_size 10M;

        ssl_certificate "/etc/letsencrypt/live/container-wave.com/fullchain.pem";
        ssl_certificate_key "/etc/letsencrypt/live/container-wave.com/privkey.pem";

        # nexus
        server_name cicd.container-wave.com;

        location / {
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_set_header X-Real-IP $remote_addr;
                proxy_pass http://192.168.200.2:18081;
                proxy_ssl_server_name on;
        }
}

server {
        listen 443 ssl http2;
        listen [::]:443 ssl http2;
        client_max_body_size 10M;

        ssl_certificate "/etc/letsencrypt/live/container-wave.com/fullchain.pem";
        ssl_certificate_key "/etc/letsencrypt/live/container-wave.com/privkey.pem";

        # grafana
        server_name mgmt.container-wave.com;

        location / {
                proxy_set_header Host $host;
                proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
                proxy_set_header X-Forwarded-Proto $scheme;
                proxy_set_header X-Real-IP $remote_addr;
                proxy_pass http://192.168.200.2;
                proxy_set_header Upgrade $http_upgrade;
                proxy_set_header Connection "upgrade";
                proxy_http_version 1.1;
                proxy_buffering off;
                proxy_cache off;
                proxy_ssl_server_name on;
        }

}